<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<appendix xml:id="migration53" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>从 PHP 5.2.x 移植到 PHP 5.3.x</title>
 <simpara>
  &manual.migration.seealso;
  <link linkend="migration5">5.0.x</link>, 
  <link linkend="migration51">5.1.x</link> 和
  <link linkend="migration52">5.2.x</link>.
 </simpara>

 <section xml:id="migration53.changes">
  <title>PHP 5.3.x 的变化</title>
  <simpara>
   PHP 5.3.x 的大多数改进对现有代码没有影响。需要注意的是有<link linkend="migration53.incompatible">一些不兼容</link>和<link linkend="migration53.new-features">新功能</link>，在生产环境中切换 PHP 版本需要先行测试代码。
  </simpara>
  <simpara>
   由更老的 PHP 版本进行升级，有一些可用的相关文档：
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="migration52">PHP 5.2.x 升级说明</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration51">PHP 5.1.x 升级说明</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration5">从 PHP 4 移植到 PHP 5</link>.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.incompatible">
  <title>不向下兼容的变化</title>
  <simpara>
   尽管大多数现有的 PHP 5 代码无需改变就可以工作，但是请注意一些不向下兼容的变化：
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
	 在 PHP 5.3.x 的所有绑定扩展中应用了新的内部参数解析API, 当给函数传递了不兼容的参数时将返回 NULL. 但有一些例外，比如函数 <function>get_class</function> 在出现错误时将会返回 &false;.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>clearstatcache</function> 默认不再清除缓存的 realpath.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>realpath</function> 现在是完全与平台无关的. 结果是非法的相对路径比如 <literal>__FILE__ . "/../x"</literal> 将不会工作.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <function>call_user_func</function> 系列函数即使被调用者是一个父类也使用 $this.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     数组函数 <function>natsort</function>, <function>natcasesort</function>, <function>usort</function>, <function>uasort</function>, <function>uksort</function>, <function>array_flip</function>, 和 <function>array_unique</function> 将不再接受对象作为参数. 在将这些函数应用于对象时, 请首先将对象转换为数组.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 按引用传递参数的函数在被按值传递调用时行为发生改变. 此前函数将接受按值传递的参数, 现在将抛出致命错误. 之前任何期待传递引用但是在调用时传递了常量或者字面值
	 的函数, 需要在调用前改为将该值赋给一个变量。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 新的 mysqlnd 库需要使用 MySQL 4.1 新的 41 字节密码格式。继续使用旧的 16 字节密码将导致 <function>mysql_connect</function> 和其它类似函数
	 抛出 <literal>"mysqlnd cannot connect to MySQL 4.1+ using old authentication."</literal> 错误.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 新的 mysqlnd 库将不再读取 MySQL 配置文件(my.cnf/my.ini), 这与旧版本的 libmysql 库不同. 如果你的代码依赖于这些配置
	 文件, 你可以使用 <function>mysqli_options</function> 显式地加载它. 注意, 这意味着如果 PDO 中的 MySQL 支持使用了 mysqlnd 进行编译，PDO 特有常量 <constant>PDO::MYSQL_ATTR_READ_DEFAULT_FILE</constant> 和
	 <constant>PDO::MYSQL_ATTR_READ_DEFAULT_GROUP</constant> 将是未定义的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <classname>SplFileInfo</classname> 及其相关目录类会移除末尾的 /.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <link linkend="language.oop5.magic.tostring">__toString</link> 魔术方法不再接受参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     魔术方法 
     <link linkend="language.oop5.overloading.members">__get</link>, 
     <link linkend="language.oop5.overloading.members">__set</link>, 
     <link linkend="language.oop5.overloading.members">__isset</link>, 
     <link linkend="language.oop5.overloading.members">__unset</link>, and
     <link linkend="language.oop5.overloading.methods">__call</link> 应该总是公共的(public)且不能是静态的(static). 方法签名是必须的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 现在 <link linkend="language.oop5.overloading.methods">__call</link> 魔术方法在访问私有的(private)和被保护的(protected)方法时被调用.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 函数内 <function>include</function> 或者 <function>require</function> 一个文件时，文件内
	 将不能使用 <function>func_get_arg</function>, <function>func_get_args</function> 和
     <function>func_num_args</function> 函数。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 新增了一个包裹在 MHASH 扩展外面的仿真层。但是并非所有的算法都涉及到了，值得注意的是 s2k 哈希算法。这意味着 s2k 哈希算法在 PHP 5.3.0 中不再可用。
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   以下关键词被保留，将不能被用作函数名, 类名等。
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="control-structures.goto">goto</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.namespaces">namespace</link>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.new-features">
  <title>新特性</title>
  <simpara>
   PHP 5.3.0 提供了广泛的新特性:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     添加了<link linkend="language.namespaces">命名空间</link>的支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     添加了<link linkend="language.oop5.late-static-bindings">静态晚绑定</link>支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     添加了<link linkend="control-structures.goto">跳标签</link>支持. 
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 添加了原生的<link linkend="functions.anonymous">闭包</link>(Lambda/匿名函数)支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     新增了两个魔术方法,
     <link linkend="language.oop5.overloading.methods">__callStatic</link> 和 
     <link linkend="language.oop5.magic.invoke">__invoke</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     添加了 <link linkend="language.types.string.syntax.nowdoc">Nowdoc</link> 语法支持, 类似于
     <link linkend="language.types.string.syntax.heredoc">Heredoc</link> 语法, 但是包含单引号.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 使用 <link linkend="language.types.string.syntax.heredoc">Heredoc</link> 来初始化静态变量和类属性/常量变为可能.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     可使用双引号声明 <link linkend="language.types.string.syntax.heredoc">Heredoc</link>, 补充了 <link linkend="language.types.string.syntax.nowdoc">Nowdoc</link> 语法.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     可在类外部使用 <literal>const</literal> 关键词声明 <link linkend="language.constants.syntax">常量</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.operators.comparison.ternary">三元运算</link>操作符有了简写形式: <literal>?:</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 HTTP 流包裹器将从 200 到 399 全部的状态码都视为成功。
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 动态访问静态方法变为可能.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.exceptions">异常</link>可以被内嵌.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 新增了循环引用的垃圾回收器并且默认是开启的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mail</function> 现在支持邮件发送日志.
     (注意: 仅支持通过该函数发送的邮件.)
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.windows">
  <title>Windows 支持改变</title>
  <simpara>
   Windows 发行版的改变:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     最小的 Windows 支持版本是 Windows XP SP3; Windows 98, ME, 2000 和 NT4 将不再被支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Windows 二进制版支持 i586 以上版本. i386 和 i486 不再被支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 Windows 上的 PHP x64 版本的支持是实验性的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     通过使用 Visual Studio 2008, 编译器现在支持 Visual C++ 9 (VC9). 基于 VC9 的快照和发行版均可用. 旧的使用 VC6 的二进制版本仍然会与 VC9 版本同时被支持和发行.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ref.pdo-oci">PDO_OCI</link> <literal>php_pdo_oci8.dll</literal> 库(配合 Oracle version 8 客户端库使用)已经不会被内建. 作为替代, 使用 <literal>php_pdo_oci.dll</literal> (注意没有 '8') 配合 Oracle 10 或 11 客户端库. 仍然支持其他数据库版本的连接.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     对于 <link linkend="book.oci8">OCI8</link> 扩展而言, 除了 <literal>php_oci8.dll</literal> 之外, 一个新的库 <literal>php_oci8_11g.dll</literal> 可用. 但仅仅只能同时打开一个库. 配合 Oracle 10.2 客户端库使用 <literal>php_oci8.dll</literal>. 配合 Oracle 11 客户端库使用 <literal>php_oci8_11g.dll</literal>. 仍然支持其他数据库版本的连接.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   新增了如下这些 Windows 支持函数:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>checkdnsrr</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>dns_get_record</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>fnmatch</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getmxrr</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getopt</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>imagecolorclosesthwb</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>inet_ntop</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>inet_pton</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>link</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>linkinfo</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mcrypt_create_iv</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>readlink</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>socket_create_pair</function>
	 - 该函数之前就可以在 Windows 平台使用, 但是自 PHP 4.3.0 起就因为一个 Bug 的原因而关闭了.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_socket_pair</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>symlink</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>time_nanosleep</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>time_sleep_until</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   其它改变:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
	 改进了 <function>stat</function>, <function>touch</function>, <function>filemtime</function>, <function>filesize</function> 等相关函数的移植性(对于可用数据100%可移植).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 现在可以使用 <function>link</function> 函数来在 Windows 平台上创建硬链接, 创建符号链接则使用 <function>symlink</function> 函数. 硬链接自 Windows 2000 起可用, 符号链接则自 Windows Vista 起可用.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 Windows 版本的 PHP 包含一组以 <literal>PHP_WINDOWS_*</literal> 为前缀的常量. 这些常量的列表可以在<xref linkend="info.constants" />找到.
    </simpara>
   </listitem>
  </itemizedlist>
  <warning>
   <simpara>
    丢弃 ISAPI 模块支持. 使用改进的 FastCGI SAPI 模块替代.
   </simpara>
  </warning>
  <note>
   <simpara>
    一个新的专注于 PHP on Windows 的站点可用, 包括下载, 发布候选版本, 和各种快照(thread-safe/not-thread-safe, VC6/VC9, x86/x64). 网站的地址是 <link xlink:href="&url.php.windows;">&url.php.windows;</link>.
   </simpara>
  </note>
 </section>

 <section xml:id="migration53.sapi">
  <title>SAPI 模块的改变</title>
  <itemizedlist>
   <listitem>
    <simpara>
     一个新增的名为 litespeed 的 SAPI 模块可用.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     CGI SAPI 中的 FastCGI 支持总是打开并且无法关闭. 更多信息请查看 <literal>sapi/cgi/CHANGES</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     一个新的 CGI SAPI 选项 <literal>-T</literal> 可以被用来衡量一个脚本的重复执行时间.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     CGI/FastCGI 现在支持 .htaccess 样式的 用户自定义 &php.ini;
     文件.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>dl</function> 函数默认被关闭, 并且现在只在 CLI, CGI, 和内嵌的 SAPI 环境下可用.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.deprecated">
  <title>PHP 5.3.x 中弃用的功能</title>
  <simpara>
   PHP 5.3.0 新增了两个错误等级: <constant>E_DEPRECATED</constant> 
   和 <constant>E_USER_DEPRECATED</constant>. 错误等级 <constant>E_DEPRECATED</constant> 被用来说明一个函数或者功能已经被弃用. <constant>E_USER_DEPRECATED</constant> 等级目的在于表明用户代码中的弃用功能, 类似于
   <constant>E_USER_ERROR</constant> 和 <constant>E_USER_WARNING</constant> 等级.
  </simpara>
  <simpara>
   下面是被弃用的 INI 指令列表. 使用下面任何指令都将导致 <constant>E_DEPRECATED</constant> 错误.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.define-syslog-variables">define_syslog_variables</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.register-globals">register_globals</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.register-long-arrays">register_long_arrays</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.safe-mode">safe_mode</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.magic-quotes-runtime">magic_quotes_runtime</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.magic-quotes-sybase">magic_quotes_sybase</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     弃用 INI 文件中以 '#' 开头的注释.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   弃用函数:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>call_user_method</function> (使用
     <function>call_user_func</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>call_user_method_array</function> (使用
     <function>call_user_func_array</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>define_syslog_variables</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>dl</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>ereg</function> (使用 <function>preg_match</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>ereg_replace</function> (使用 <function>preg_replace</function>
     替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>eregi</function> (使用 <function>preg_match</function> 配合
     <literal>'i'</literal> 修正符替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>eregi_replace</function> (使用 <function>preg_replace</function>
     配合 <literal>'i'</literal> 修正符替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>set_magic_quotes_runtime</function> 以及它的别名函数 <function>magic_quotes_runtime</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_register</function> (使用
     <varname>$_SESSION</varname> 超全部变量替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_unregister</function> (使用
     <varname>$_SESSION</varname> 超全部变量替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_is_registered</function> (使用
     <varname>$_SESSION</varname> 超全部变量替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>set_socket_blocking</function> (使用
     <function>stream_set_blocking</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>split</function> (使用 <function>preg_split</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>spliti</function> (使用 <function>preg_split</function> 配合
     <literal>'i'</literal> 修正符替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>sql_regcase</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysql_db_query</function> (使用
     <function>mysql_select_db</function> 和 <function>mysql_query</function>
     替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysql_escape_string</function> (使用 <function>mysql_real_escape_string</function> 替代)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     废弃以字符串传递区域设置名称. 使用 LC_* 系列常量替代.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mktime</function> 的 <parameter>is_dst</parameter> 参数. 使用新的时区处理函数替代.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   弃用的功能:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
	 弃用通过引用分配 <link linkend="language.oop5.basic.new">new</link> 的返回值.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 调用时传递引用被弃用.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.undeprecated">
  <title>PHP 5.3.x 保留的功能</title>
  <simpara>
   <function>is_a</function> 函数被保留. 它不再抛出 <constant>E_STRICT</constant> 错误.
  </simpara>
 </section>

 <section xml:id="migration53.parameters">
  <title>新参数</title>
  <simpara>
   在 PHP 5.3 中一些函数新增了参数和选项:
  </simpara>
  <simpara>PHP 核心:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>clearstatcache</function>
     - 新增 <parameter>clear_realpath_cache</parameter> 和
     <parameter>filename</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>copy</function>
     - 新增流环境参数 <parameter>context</parameter>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>fgetcsv</function>
     - 新增 <parameter>escape</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>ini_get_all</function>
     - 新增 <parameter>details</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>nl2br</function>
     - 新增 <parameter>is_xhtml</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>parse_ini_file</function>
     - 新增 <parameter>scanner_mode</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>round</function>
     - 新增 <parameter>mode</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_context_create</function>
     - 新增 <parameter>params</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>strstr</function> 和 <function>stristr</function> 
     - 新增 <parameter>before_needle</parameter> 参数.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.json">json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>json_encode</function>
     - 新增 <parameter>options</parameter> 参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>json_decode</function>
     - 新增 <parameter>depth</parameter> 参数.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.stream">流(Streams)</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>stream_select</function>,
     <function>stream_set_blocking</function>,
     <function>stream_set_timeout</function>, 和
     <function>stream_set_write_buffer</function> 使用用户空间流包裹器.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.sybase">sybase_ct</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>sybase_connect</function>
     - 新增 <parameter>new</parameter> 参数.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara>
   PHP 5.3.0 中的新方法参数:
  </simpara>
  <simpara>PHP 核心:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>Exception::__construct</methodname>
     - 新增 <parameter>previous</parameter> 参数.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.functions">
  <title>新函数</title>
  <simpara>
   PHP 5.3 引入了一些新函数:
  </simpara>

  <simpara>PHP 核心:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>array_replace</function>
     - 将一个数组的元素用另外一个数组的元素进行替换.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>array_replace_recursive</function>
     - 将一个数组的元素用一组传递进来的数组进行递归替换.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>class_alias</function>
     - 为用户定义的类创建一个别名.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>forward_static_call</function>
     - 从一个方法环境调用一个用户函数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>forward_static_call_array</function>
     - 从一个方法环境调用一个用户函数, 使用数组中的元素作为参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>gc_collect_cycles</function>
     - 强制收集任何存在的废物循环.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>gc_disable</function>
     - 撤销循环引用收集器.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>gc_enable</function>
     - 激活循环引用收集器.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>gc_enabled</function>
     - 返回循环引用收集器的状态.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_called_class</function>
	 - 返回调用的静态方法所在的类的名称.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>gethostname</function>
     - 返回本地机器的当前主机名.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>header_remove</function>
	 - 在使用 <function>header</function> 函数之前移除 HTTP Header.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>lcfirst</function>
     - 蒋某一字符串第一个字符转化为小写.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>parse_ini_string</function>
     - 解析配置字符串.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>quoted_printable_encode</function>
     - 转换 8 位的字符串为引用的可打印字符串.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>str_getcsv</function>
     - 将 CSV 字符串解析为数组.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_context_set_default</function>
     - 设置默认的流环境.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_supports_lock</function>
     - 如果流支持锁定则返回 &true;.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_context_get_params</function>
     - 获取一个流环境的参数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>streamWrapper::stream_cast</function>
     - 获取底层的流资源.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>streamWrapper::stream_set_option</function>
     - 更改流选项
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.datetime">Date/Time</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>date_add</function>
	 - 向 <classname>DateTime</classname> 对象增加一定数量的天, 月, 年, 小时, 分钟和秒数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>date_create_from_format</function>
	 - 根据给定的格式, 返回一个 <classname>DateTime</classname> 对象.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>date_diff</function>
     - 返回两个 <classname>DateTime</classname> 对象的不同之处.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>date_get_last_errors</function>
	 - 返回最后的日期/时间操作中产生的警告和错误.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>date_parse_from_format</function>
     - 获取一个日期的信息.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>date_sub</function>
	 - 从 <classname>DateTime</classname> 对象减去一定数量的天, 月, 年, 时和秒数.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>timezone_version_get</function>
     - 返回时区数据库的版本.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.gmp">GMP</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>gmp_testbit</function>
     - 测试一个比特是否被设置.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.hash">Hash</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>hash_copy</function>
     - 复制哈希环境.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.imap">IMAP</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>imap_gc</function>
     - 清除 IMAP 缓存.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>imap_utf8_to_mutf7</function>
     - 编码 UTF-8 字符串为改进的 UTF-7 编码.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>imap_mutf7_to_utf8</function>
     - 解码改进的 UTF-7 字符串为 UTF-8 编码.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.json">JSON</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>json_last_error</function>
     - 返回最后发生的 JSON 错误.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.mysqli">MySQL 改进</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysqli_fetch_all</function>
     - 以关联数组、索引数组或者二者都有获取全部结果行.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysqli_get_connection_stats</function>
     - 返回客户端连接的统计资料.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysqli_poll</function>
     - 轮询连接.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysqli_reap_async_query</function>
     - 从异步查询中获取结果.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.openssl">OpenSSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>openssl_random_pseudo_bytes</function>
     - 返回一个以伪随机字节填充的指定长度的字符串.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.pcntl">PCNTL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>pcntl_signal_dispatch</function>
     - 为挂起信号调用信号处理器.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>pcntl_sigprocmask</function>
     - 设置和获取阻塞信号.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>pcntl_sigtimedwait</function>
     - 等待信号, 但是有超时时间.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>pcntl_sigwaitinfo</function>
     - 等待信号.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.pcre">PCRE</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>preg_filter</function>
     - 执行正则查找和替换, 仅仅返回匹配正则的结果.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.sem">信号</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>msg_queue_exists</function>
     - 检查消息队列是否存在.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>shm_has_var</function>
	 - 检查在一个共享内存段中, 是否存在指定的键(key).
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara>
   以下函数被原生支持, 因此它们在所有运行 PHP 的操作系统上均可用.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>acosh</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>asinh</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>atanh</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>expm1</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>log1p</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.new-stream-wrappers">
  <title>新的流包装器</title>
  <simpara>
   5.3.0 中新增了以下流包装器:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="wrappers.glob">glob://</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="wrappers.phar">phar://</link>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.new-stream-filters">
  <title>新的流过滤器</title>
  <simpara>
   5.3.0 新增了以下流过滤器:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     dechunk (反转 HTTP 块编码)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     bz2.decompress 过滤器支持连续操作.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.class-constants">
  <title>新增的类常量</title>
  <simpara>
   5.3.0 中新增了若干类常量:
  </simpara>

  <simpara><link linkend="ref.pdo-firebird">PDO_FIREBIRD</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PDO::FB_ATTR_DATE_FORMAT</constant>
     - 为日期设置格式.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::FB_ATTR_TIME_FORMAT</constant>
     - 为时间设置格式.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PDO::FB_ATTR_TIMESTAMP_FORMAT</constant>
     - 为时间戳设置格式.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.methods">
  <title>新增的方法</title>
  <simpara>
   5.3.0 中新增了若干方法:
  </simpara>

  <simpara><link linkend="book.datetime">日期/时间</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>DateTime::add</function>
     - 向一个 <classname>DateTime</classname> 对象加上若干天, 月, 年, 小时, 分钟和秒.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>DateTime::createFromFormat</function>
     - 根据给定的格式, 返回一个新的格式化的<classname>DateTime</classname>对象.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>DateTime::diff</function>
     - 返回两个 <classname>DateTime</classname> 对象的不同之处.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>DateTime::getLastErrors</function>
     - 返回最后的日期/时间处理中的警告和错误.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>DateTime::sub</function>
     - 从 <classname>DateTime</classname> 对象中减去若干天, 月, 年, 小时, 分钟和秒.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><classname>异常(Exception)</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>Exception::getPrevious</function>
     - 获取前一个异常.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.dom">DOM</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>DOMNode::getLineNo</function>
     - 返回解析节点的行数.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="ref.pdo-firebird">PDO_FIREBIRD</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>PDO::setAttribute</function>
     - 设置属性.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.reflection">反射(Reflection)</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>ReflectionClass::getNamespaceName</methodname>
     - 返回类定义所在命名空间的的名称.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionClass::getShortName</methodname>
     - 返回类的短名称(没有命名空间部分).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionClass::inNamespace</methodname>
     - 返回类是否定义于一个命名空间.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionFunction::getNamespaceName</methodname>
     - 返回函数定义所在命名空间的名字.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionFunction::getShortName</methodname>
     - 返回函数的段名称(没有命名空间部分).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionFunction::inNamespace</methodname>
     - 返回函数在一个命名空间中是否被定义.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionProperty::setAccessible</methodname>
     - 设置是否可以请求非 public 属性.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>SplObjectStorage::addAll</function>
     - 从另一个 SplObjectStorage 对象中新增全部元素.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>SplObjectStorage::removeAll</function>
     - 从另一个 SplObjectStorage 对象中移除全部元素.
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.xsl">XSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>XSLTProcessor::setProfiling</function>
     - 设置概况输出文件.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.new-extensions">
  <title>新的扩展</title>
  <simpara>
   PHP 5.3.0 新增以下扩展(默认):
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.enchant">Enchant</link>
     - 各种拼写库的抽象层
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.fileinfo">文件信息</link>
     - 已经被移除的 <link linkend="book.mime-magic">Mimetype</link> 扩展的一个改进的、更加可靠的替代, 以 BC 为特色.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.intl">INTL</link>
     - 国际化扩展. INTL 是 <link xlink:href="&url.icu.home;">ICU</link> 库的一个包装器.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.phar">Phar</link>
     - PHP 档案文件的实现.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.sqlite3">SQLite3</link>
     - 支持 SQLite version 3 数据库.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   mysqlnd 是随 PHP 发布的新核心库. 它是 PHP 独有的 libmysql 的替代. 如果系统上未发现 libmysql, mysqlnd 将被用来构建 <link linkend="book.mysql">mysql</link>,
   <link linkend="book.mysqli">mysqli</link> 
   和 <link linkend="ref.pdo-mysql">PDO_MySQL</link> 扩展. 甚至 libmysql 存在的情况下, 它也可以被用来代替 libmysql. 由于性能上的原因, 推荐在全部的 PHP 安装中都使用 mysqlnd.
  </simpara>
 </section>

 <section xml:id="migration53.removed-extensions">
  <title>被移除的扩展</title>
  <simpara>
   这些扩展已经被移动至 PECL 并且不再是 PHP 发布的一部分. 这些扩展的 PECL 包版本将根据用户需求创建.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.dbase">dbase</link>
     - 不再被保持
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.fbsql">fbsql</link>
     - 不再被保持
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.fdf">fdf</link> 
     - 被保持
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.ming">ming</link> 
     - 被保持
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.msql">msql</link>
     - 不再被保持
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.ncurses">ncurses</link> 
     - 被保存
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.sybase">sybase</link>
     - 停用; 使用 <link linkend="book.sybase">sybase_ct</link> 扩展代替.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.mhash">mhash</link>
     - 停用; 使用 <link linkend="book.hash">hash</link> 扩展代替. <link linkend="book.hash">hash</link> 全兼容 mhash; 全部使用旧函数的应用程序仍将可以工作.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.extensions-other">
  <title>Other changes to extensions</title>
  <simpara>
   以下扩展不再能在编译配置时进行关闭:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.pcre">PCRE</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.reflection">反射</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.spl">SPL</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   扩展行为和新功能的改变:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.datetime">日期和时间</link>
     - 获取时区时不再使用 TZ 环境变量.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.curl">cURL</link>
     - cURL 支持 SSH
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.network">Network</link>
     - <function>dns_check_record</function> 现在返回一个额外的 "entries"
     索引, 包含 TXT 元素.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.hash">Hash</link>
     - SHA-224 和 salsa 哈希算法获得支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.mbstring">mbstring</link>
     - 现在支持 CP850 编码.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.oci8">OCI8</link>
     - 在持久连接上调用 <function>oci_close</function> 或者在作用域外引用持久连接, 将回滚任何尚未提交的事务. 为了避免意外的行为, 根据需要明确发布和回滚事务. 使用 INI 指令<link linkend="ini.oci8.old-oci-close-semantics">oci8.old_oci_close_semantics</link>可以打开旧的行为.
    </simpara>
    <simpara>
     数据库驻留连接池(DRCP)和快速应用通知(FAN)获得支持.
    </simpara>
    <simpara>
     Oracle 外部认证获得支持(除了 Windows 平台).
    </simpara>
    <simpara>
     <function>oci_bind_by_name</function> 函数现在支持 SQLT_AFC
     (又称 CHAR 数据类型).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.openssl">OpenSSL</link>
     - 支持 OpenSSL 摘要和加密函数. 访问 DSA, RSA 和 DH 键的内部值变为可能.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.session">Session</link>
     - 当应用了 <link linkend="ini.open-basedir">open_basedir</link> 限制, Session 不再将 Session 文件存储在 <literal>"/tmp"</literal> 目录中, 除非 <literal>"/tmp"</literal> 目录被明确添加到许可路径列表.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.soap">SOAP</link> 支持发送用户提供的 HTTP 头.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.mysqli">MySQLi</link>
     通过在主机名前面添加 <literal>"p:"</literal> 来支持持久连接.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.image">图片处理和 GD</link>
	 <function>gd_info</function> 函数返回的 "JPG Support" 索引变更为 "JPEG Support".
    </simpara>
   </listitem>


  </itemizedlist>
 </section>

 <section xml:id="migration53.classes">
  <title>新类</title>
  <simpara>
   PHP 5.3.0 新增了以下类:
  </simpara>

  <simpara><link linkend="book.datetime">日期/时间</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>DateInterval</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>DatePeriod</classname>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.phar">Phar</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>Phar</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>PharData</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>PharException</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>PharFileInfo</classname>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>FilesystemIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>GlobIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>MultipleIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>RecursiveTreeIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplDoublyLinkedList</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplFixedArray</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplHeap</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplMaxHeap</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplMinHeap</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplPriorityQueue</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplQueue</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SplStack</classname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.global-constants">
  <title>新的全局常量</title>

  <simpara>PHP 核心:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>__DIR__</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>__NAMESPACE__</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>E_DEPRECATED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>E_USER_DEPRECATED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INI_SCANNER_NORMAL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INI_SCANNER_RAW</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_MAXPATHLEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_NT_DOMAIN_CONTROLLER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_NT_SERVER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_NT_WORKSTATION</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_BUILD</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_MAJOR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_MINOR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_PLATFORM</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_PRODUCTTYPE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_SP_MAJOR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_SP_MINOR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_WINDOWS_VERSION_SUITEMASK</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.curl">cURL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>CURLOPT_PROGRESSFUNCTION</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.image">GD</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>IMG_FILTER_PIXELATE</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.json">JSON</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>JSON_ERROR_CTRL_CHAR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_ERROR_DEPTH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_ERROR_NONE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_ERROR_STATE_MISMATCH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_ERROR_SYNTAX</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_FORCE_OBJECT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_HEX_TAG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_HEX_AMP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_HEX_APOS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_HEX_QUOT</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.ldap">LDAP</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>LDAP_OPT_NETWORK_TIMEOUT</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.libxml">libxml</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>LIBXML_LOADED_VERSION </constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.pcre">PCRE</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PREG_BAD_UTF8_OFFSET_ERROR</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.pcntl">PCNTL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>BUS_ADRALN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>BUS_ADRERR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>BUS_OBJERR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_CONTIUNED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_DUMPED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_EXITED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_KILLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_STOPPED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CLD_TRAPPED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTDIV</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTINV</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTOVF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTRES</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTSUB</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_FLTUND</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_INTDIV</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>FPE_INTOVF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_BADSTK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_COPROC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_ILLADR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_ILLOPC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_ILLOPN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_ILLTRP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_PRVOPC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ILL_PRVREG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_ERR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_HUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_IN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_MSG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_OUT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>POLL_PRI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SEGV_ACCERR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SEGV_MAPERR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_ASYNCIO</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_KERNEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_MESGQ</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_NOINFO</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_QUEUE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_SIGIO</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_TIMER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_TKILL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SI_USER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SIG_BLOCK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SIG_SETMASK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>SIG_UNBLOCK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>TRAP_BRKPT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>TRAP_TRACE</constant>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.ini">
  <title>INI 文件处理改变</title>
  <simpara>
   PHP 5.3.0 显著改进了 INI 文件的性能和解析, 并且新增了若干语法功能.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     标准的 &php.ini; 文件被重新组织和命名. 
     <literal>php.ini-development</literal> 包含在开发环境中推荐使用的设置. <literal>php.ini-production</literal>
     包含在生产环境中推荐使用的设置.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     支持两个特殊章节:
     <literal>[PATH=/opt/httpd/www.example.com/]</literal> 和 
     <literal>[HOST=www.example.com]</literal>. 这两个章节里的指令不能被用户定义的 INI 文件或者运行时覆盖. 关于这些章节的更多信息, 可以<link linkend="ini.sections">这里</link>找到.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     移除了 <literal>zend_extension_debug</literal> and
     <literal>zend_extension_ts</literal>. 使用
     <literal>zend_extension</literal> 指令来加载全部 Zend 扩展.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     移除了 <literal>zend.ze1_compatibility_mode</literal>. 如果该 INI 指令被设置为 On, 启动时将抛出 <constant>E_ERROR</constant> 级别错误.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 在 "<link linkend="ini.extension"><literal>extension</literal></link>" 指令中可以使用全路径来加载模块.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>"ini变量"</literal> 现在几乎在 &php.ini; 文件的任何地方都可以使用.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 可以在运行时收紧 <literal>open_basedir</literal> 限制条件.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 可以在 INI 选项数组中使用字母数字或者变量.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_cfg_var</function> 现在可以返回 "数组(array)" INI 选项.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     添加了一个新指令 mail.add_x_header.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     user_ini.filename 是新增的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     user_ini.cache_ttl 也是新增的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     exit_on_timeout 也是新增的.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     open_basedir 现在是 PHP_INI_ALL 的.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   新增以下指令:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     新的 .htaccess-style 用户 INI 文件机制中的 <literal>user_ini.filename</literal> 和
     <literal>user_ini.cache_ttl</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     新增 <literal>mbstring.http_output_conv_mimetype</literal>. 
	 该指令指定了 <function>mb_output_handler</function> 激活内容类型的正则表达式.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     新增 <literal>request_order</literal>. 允许控制哪些外部变量在 <varname>$_REQUEST</varname> 中可用.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   以下 ini 指令默认值更新:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <literal>session.use_only_cookies</literal> 默认被设置为 <literal>"1"</literal>(打开).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>oci8.default_prefetch</literal> 变更为从 <literal>"10"</literal> 到 <literal>"100"</literal>.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration53.other">
  <title>其他改变</title>
  <itemizedlist>
   <listitem>
    <simpara>
	 <function>SplFileInfo::getpathinfo</function> 现在返回 path name 信息.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <classname>SplObjectStorage</classname> 现在支持 <classname>ArrayAccess</classname>. 现在可以在 <classname>SplObjectStorage</classname> 中存储关联信息对象.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 在 GD 扩展中, 通过 <function>imagefilter</function> 函数, 可以提供像素支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>var_dump</function> 的输出现在包含对象的私有属性.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 如果会话启动失败, <function>session_start</function> 现在将返回 &false;.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <function>property_exists</function> 可以检查一个属性的存在性, 而不管它的访问控制类型(类似于 <function>method_exists</function>).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <link linkend="ini.include-path">include_path</link> 现在可以使用<link linkend="wrappers">Stream 包装器</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <function>array_reduce</function> 函数的 <parameter>initial</parameter> 参数现在可以是任何类型.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 如果没有明确传递上下文环境, <link linkend="ref.dir">目录函数</link> <function>opendir</function>, <function>scandir</function>, 和
     <function>dir</function> 将使用默认的流上下文环境.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <function>crypt</function> 函数支持 Blowfish 和 DES 算法, 并且 <function>crypt</function> 的特点是非常便捷. 
	 PHP 有它自己内部的算法实现, 不管是否找到 <literal>crypt</literal> 或 <literal>crypt_r</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 在全部平台上, <function>getopt</function> 开始接受"长选项". 可选值和作为短选项分隔符的 <literal>=</literal> 被支持.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
	 <function>fopen</function> 新增了一个模式选项(<literal>n</literal>), 它传递 <constant>O_NONBLOCK</constant> 常量给底层的 <literal>open()</literal> 系统调用. 注意, Windows 上该模式尚未得到支持. 
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getimagesize</function> 现在支持 icon 文件 (.ico).
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     mhash 扩展已经移动至 PECL, 但如果 PHP 使用 <literal>--with-mhash</literal> 选项参数进行编译, <link linkend="ref.hash">Hash</link> 扩展也将提供 mhash 支持. 注意, 不管是否开启 mhash 算法, Hash 扩展都无需 mhash 库可用.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
