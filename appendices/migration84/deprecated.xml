<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: d2939d46110158f98ace5c20761c808b51366a82 Maintainer: mowangjuanzi Status: ready -->
<sect1 xml:id="migration84.deprecated">
 <title>弃用功能</title>

 <sect2 xml:id="migration84.deprecated.core">
  <title>PHP 核心</title>

  <sect3 xml:id="migration84.deprecated.core.implicitly-nullable-parameter">
   <!-- RFC: https://wiki.php.net/rfc/deprecate-implicitly-nullable-types -->
   <title>隐式可空参数</title>

   <simpara>
    如果参数的默认值为 &null;，则其类型会被隐式扩展为接受 <type>null</type>。
   </simpara>

   <para>
    以下代码：
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(T1 $a = null) {}
]]>
     </programlisting>
    </informalexample>
    应改为：
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(T1|null $a = null) {}
]]>
     </programlisting>
    </informalexample>
    或
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(?T1 $a = null) {}
]]>
     </programlisting>
    </informalexample>
   </para>

   <para>
    但是，如果此类参数声明后面跟着一个必需参数：
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(T1 $a, T2 $b = null, T3 $c) {}
]]>
     </programlisting>
    </informalexample>
    则必须改为：
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(T1 $a, T2|null $b, T3 $c) {}
]]>
     </programlisting>
    </informalexample>
    或
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
function foo(T1 $a, ?T2 $b, T3 $c) {}
]]>
     </programlisting>
    </informalexample>
    因为在必需参数前面放置可选参数已被弃用。
   </para>
  </sect3>

  <sect3>
   <!-- RFC: https://wiki.php.net/rfc/raising_zero_to_power_of_negative_number -->
   <title>将零的负数次幂</title>

   <simpara>
    将一个数提升到负数次幂等价于取该数的正数次幂的倒数。即
    <literal>10<superscript>-2</superscript></literal> 等同于
    <literal>1 / 10<superscript>2</superscript></literal>。
    因此，将 <literal>0</literal> 提升到负数次幂相当于除以 <literal>0</literal>，即
    <literal>0<superscript>-2</superscript></literal> 等同于
    <literal>1 / 0<superscript>2</superscript></literal>，也就是
    <literal>1 / 0</literal>。因此，此行为已被弃用。
   </simpara>

   <simpara>
    这影响幂运算符 <literal>**</literal>
    和 <function>pow</function> 函数。
   </simpara>

   <simpara>
    如果需要 IEEE 754 语义，应使用新的
    <function>fpow</function> 函数。
   </simpara>
  </sect3>

  <sect3 xml:id="migration84.deprecated.core.underscore-class-name">
   <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_using_a_single_underscore_as_a_class_name -->
   <title>使用下划线 <literal>_</literal> 作为类名</title>

   <para>
    将类命名为 <literal>_</literal> 现已弃用：
    <informalexample>
     <programlisting role="php">
<![CDATA[
<?php
class _ {}
]]>
     </programlisting>
    </informalexample>
   </para>

   <note>
    <para>
     以下划线开头的类名<emphasis>不受</emphasis>此弃用影响：
     <informalexample>
      <programlisting role="php">
<![CDATA[
<?php
class _MyClass {}
]]>
      </programlisting>
     </informalexample>
    </para>
   </note>
  </sect3>

  <sect3>
   <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_passing_e_user_error_to_trigger_error -->
   <title>
    将 <constant>E_USER_ERROR</constant> 传递给
    <function>trigger_error</function>
   </title>

   <simpara>
    以 <parameter>error_level</parameter> 等于
    <constant>E_USER_ERROR</constant> 调用 <function>trigger_error</function>
    现已弃用。
   </simpara>

   <simpara>
    此类用法应替换为抛出异常或调用 <function>exit</function>，
    视具体情况选择更合适的方式。
   </simpara>
  </sect3>

  <sect3>
   <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#remove_e_strict_error_level_and_deprecate_e_strict_constant -->
   <title>
    <constant>E_STRICT</constant> 常量
   </title>

   <simpara>
    由于 <constant>E_STRICT</constant> 错误级别已被移除，
    此常量现已弃用。
   </simpara>
  </sect3>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.curl">
  <title>cURL</title>

  <simpara>
   <constant>CURLOPT_BINARYTRANSFER</constant> 常量现已弃用。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.date">
  <title>Date</title>

  <simpara>
   <code> DatePeriod::__construct(string $isostr, int $options = 0)</code>
   签名已被弃用。请改用
   <methodname>DatePeriod::createFromISO8601String</methodname>。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#constants_sunfuncs_ret_string_sunfuncs_ret_double_sunfuncs_ret_timestamp -->
  <simpara>
   <constant>SUNFUNCS_RET_TIMESTAMP</constant>、
   <constant>SUNFUNCS_RET_STRING</constant>
   和 <constant>SUNFUNCS_RET_DOUBLE</constant> 常量现已弃用。
   这是继 PHP 8.1.0 弃用 <function>date_sunset</function> 和
   <function>date_sunrise</function> 函数之后的后续操作。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.dba">
  <title>DBA</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_passing_null_and_false_to_dba_key_split -->
  <simpara>
   向 <function>dba_key_split</function> 传递 &null; 或 &false; 现已弃用。
   在这些情况下，该函数始终返回 &false;。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.dom">
  <title>DOM</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_dom_php_err_constant -->
  <simpara>
   <constant>DOM_PHP_ERR</constant> 常量现已弃用。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#formally_deprecate_soft-deprecated_domdocument_and_domentity_properties -->
  <para>
   以下属性已被正式弃用：
   <simplelist>
    <member><property>DOMDocument::$actualEncoding</property></member>
    <member><property>DOMDocument::$config</property></member>
    <member><property>DOMEntity::$actualEncoding</property></member>
    <member><property>DOMEntity::$encoding</property></member>
    <member><property>DOMEntity::$version</property></member>
   </simplelist>
  </para>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.hash">
  <title>Hash</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_passing_incorrect_data_types_for_options_to_exthash_functions -->
  <simpara>
   向哈希函数传递无效选项现已弃用。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.intl">
  <title>Intl</title>

  <simpara>
   使用超过两个参数调用 <function>intlcal_set</function> 或
   <methodname>IntlCalendar::set</methodname>
   已被弃用。请改用 <methodname>IntlCalendar::setDate</methodname> 或
   <methodname>IntlCalendar::setDateTime</methodname>。
  </simpara>

  <simpara>
   使用超过两个参数调用 <function>intlgregcal_create_instance</function> 或
   <methodname>IntlGregorianCalendar::__construct</methodname>
   已被弃用。请改用
   <methodname>IntlGregorianCalendar::createFromDate</methodname> 或
   <methodname>IntlGregorianCalendar::createFromDateTime</methodname>。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.ldap">
  <title>LDAP</title>

  <simpara>
   使用超过两个参数调用 <function>ldap_connect</function>
   已被弃用。请改用 <function>ldap_connect_wallet</function>。
  </simpara>

  <simpara>
   使用超过四个参数调用 <function>ldap_exop</function>
   已被弃用。请改用 <function>ldap_exop_sync</function>。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.mysqli">
  <title>MySQLi</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#mysqli_ping_and_mysqliping -->
  <simpara>
   <function>mysqli_ping</function> 函数和
   <methodname>mysqli::ping</methodname> 方法现已弃用，
   因为重连功能已在 PHP 8.2.0 中移除。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_mysqli_kill -->
  <simpara>
   <function>mysqli_kill</function> 函数和
   <methodname>mysqli::kill</methodname> 方法现已弃用。
   如果需要此功能，可以改用 SQL <literal>KILL</literal> 命令。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_mysqli_refresh -->
  <simpara>
   <function>mysqli_refresh</function> 函数和
   <methodname>mysqli::refresh</methodname> 方法现已弃用。
   如果需要此功能，可以改用 SQL <literal>FLUSH</literal> 命令。
   所有 <constant>MYSQLI_REFRESH_<replaceable>*</replaceable></constant>
   常量也已被弃用。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_the_second_parameter_to_mysqli_store_result -->
  <simpara>
   显式传递 <parameter>mode</parameter> 参数给
   <function>mysqli_store_result</function> 已被弃用。
   由于 <constant>MYSQLI_STORE_RESULT_COPY_DATA</constant> 常量
   仅与此函数配合使用，因此也已被弃用。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.pdo-pgsql">
  <title>PDO_PGSQL</title>

  <simpara>
   在美元引用字符串中使用转义的问号（<literal>??</literal>）已被弃用。
   由于 PDO_PGSQL 现在拥有自己的支持美元引用字符串的 SQL 解析器，
   不再需要在其中转义问号。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.pgsql">
  <title>PGSQL</title>

  <simpara>
   <function>pg_fetch_result</function>、
   <function>pg_field_prtlen</function> 和
   <function>pg_field_is_null</function> 的两参数签名现已弃用。
   请改用三参数签名，并将 <parameter>row</parameter> 设置为
   &null;。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.random">
  <title>Random</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_lcg_value -->
  <simpara>
   <function>lcg_value</function> 现已弃用，
   因为该函数存在多方面的问题。
   请改用 <methodname>Random\Randomizer::getFloat</methodname>。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.reflection">
  <title>Reflection</title>

  <simpara>
   使用一个参数调用 <methodname>ReflectionMethod::__construct</methodname>
   已被弃用。
   请改用 <methodname>ReflectionMethod::createFromMethodName</methodname>。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.session">
  <title>Session</title>

  <simpara>
   使用超过两个参数调用 <function>session_set_save_handler</function>
   已被弃用。请改用两参数签名。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#sessionsid_length_and_sessionsid_bits_per_character -->
  <simpara>
   修改
   <link linkend="ini.session.sid-length"><literal>session.sid_length</literal></link> 和
   <link linkend="ini.session.sid-bits-per-character"><literal>session.sid_bits_per_character</literal></link>
   INI 设置的值已被弃用。
   请更新会话存储后端以接受 32 个字符的十六进制会话 ID，
   并停止修改这两个 INI 设置。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecate-get-post-sessions -->
  <simpara>
   修改
   <link linkend="ini.session.use-only-cookies"><literal>session.use_only_cookies</literal></link>、
   <link linkend="ini.session.use-trans-sid"><literal>session.use_trans_sid</literal></link>、
   <link linkend="ini.session.trans-sid-tags"><literal>session.trans_sid_tags</literal></link>、
   <link linkend="ini.session.trans-sid-hosts"><literal>session.trans_sid_hosts</literal></link> 和
   <link linkend="ini.session.referer-check"><literal>session.referer_check</literal></link>
   INI 设置的值已被弃用。
   <constant>SID</constant> 常量也已被弃用。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.soap">
  <title>SOAP</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_soap_functions_all_constant_and_passing_it_to_soapserveraddfunction -->
  <simpara>
   向 <methodname>SoapServer::addFunction</methodname> 传递
   <type>int</type> 现已弃用。
   如果需要提供所有 PHP 函数，请展平
   <function>get_defined_functions</function> 返回的数组。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_soap_functions_all_constant_and_passing_it_to_soapserveraddfunction -->
  <simpara>
   <constant>SOAP_FUNCTIONS_ALL</constant> 常量现已弃用。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.spl">
  <title>SPL</title>

  <simpara>
   <methodname>SplFixedArray::__wakeup</methodname> 方法现已弃用，
   因为它实现了
   <methodname>SplFixedArray::__serialize</methodname> 和
   <methodname>SplFixedArray::__unserialize</methodname>，
   需要覆盖的是后两个方法。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_proprietary_csv_escaping_mechanism -->
  <simpara>
   对 <methodname>SplFileObject::setCsvControl</methodname>、
   <methodname>SplFileObject::fputcsv</methodname> 和
   <methodname>SplFileObject::fgetcsv</methodname>
   的 <parameter>escape</parameter> 参数使用默认值现已弃用。
   <!-- TODO: Link to named arguments feature -->
   必须通过位置参数或命名参数显式传递该值。
   如果已使用 <methodname>SplFileObject::setCsvControl</methodname>
   设置了新的默认值，则此规则不适用于
   <methodname>SplFileObject::fputcsv</methodname>
   和 <methodname>SplFileObject::fgetcsv</methodname>。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.standard">
  <title>Standard</title>

  <simpara>
   使用两个参数调用 <function>stream_context_set_option</function>
   已被弃用。请改用 <function>stream_context_set_options</function>。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#unserialize_s_s_tag -->
  <simpara>
   使用 <function>unserialize</function> 反序列化带有大写 <literal>S</literal>
   标签的字符串已被弃用。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#deprecate_proprietary_csv_escaping_mechanism -->
  <simpara>
   对 <function>fputcsv</function>、
   <function>fgetcsv</function> 和
   <function>str_getcsv</function> 的 <parameter>escape</parameter>
   参数使用默认值现已弃用。
   <!-- TODO: Link to named arguments feature -->
   必须通过位置参数或命名参数显式传递该值。
  </simpara>
 </sect2>

 <sect2 xml:id="migration84.deprecated.core.xml">
  <title>XML</title>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#xml_set_object_and_xml_set_handler_with_string_method_names -->
  <simpara>
   <function>xml_set_object</function> 函数已被弃用。
  </simpara>

  <!-- RFC: https://wiki.php.net/rfc/deprecations_php_8_4#xml_set_object_and_xml_set_handler_with_string_method_names -->
  <simpara>
   向 <function>xml_set_<replaceable>*</replaceable></function>
   函数传递非 <type>callable</type> 字符串现已弃用。
  </simpara>
 </sect2>

</sect1>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
